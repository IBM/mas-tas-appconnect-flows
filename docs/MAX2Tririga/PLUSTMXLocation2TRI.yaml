$integration: http://ibm.com/appconnect/integration/v2/integrationFile
integration:
  type: api
  trigger-interfaces:
    trigger-interface-1:
      triggers:
        synclocationTriLocation:
          assembly:
            $ref: '#/integration/assemblies/assembly-1'
          input-context:
            data: mxLocation
          output-context:
            data: triLocation
      options:
        resources:
          - business-object: mxLocation
            model:
              $ref: '#/models/mxLocation'
            triggers: {}
          - business-object: triLocation
            model:
              $ref: '#/models/triLocation'
            triggers:
              synclocation: synclocationTriLocation
      type: api-trigger
  action-interfaces:
    action-interface-2:
      type: api-action
      business-object: request
      connector-type: http
      account-name: mxtririga
      actions:
        INVOKE: {}
    action-interface-5:
      type: api-action
      business-object: request
      connector-type: http
      account-name: trimaximo
      actions:
        INVOKE: {}
  assemblies:
    assembly-1:
      assembly:
        execute:
          - set-variable:
              name: Set variable
              map:
                $map: http://ibm.com/appconnect/map/v1
                input:
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: flowDetails
                    $ref: '#/flowDetails'
                customSchemas:
                  properties.`variable`:
                    type: object
                    properties:
                      member:
                        type: array
                        items:
                          type: object
                          properties: {}
                mappings:
                  - variable:
                      mappings:
                        - member:
                            expression: >-
                              $count(member) > 0 ? $Request.member  :
                              $append([],$$)
          - parse:
              name: JSON Parser Parse
              parse-format: json
              source:
                template: '{{$Setvariable.variable}}'
                input:
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
              sample-data: |-
                {
                  "member":[
                    {
                  "_action": "Delete",
                  "_rowstamp": "132962",
                  "children": false,
                  "externalrefid": "56543467",
                  "location": "OFF105",
                  "locations": [
                    {
                      "_rowstamp": "132731",
                      "autowogen": false,
                      "changeby": "MAXIMO",
                      "changedate": "1999-12-07T14:34:00-08:00",
                      "description": "Office #105",
                      "disabled": false,
                      "glaccount": "6220-300-???",
                      "hasld": false,
                      "isdefault": false,
                      "isrepairfacility": false,
                      "langcode": "EN",
                      "locationsid": 198,
                      "orgid": "EAGLENA",
                      "pluscloop": false,
                      "pluscpmextdate": false,
                      "replacecost": 0,
                      "status": "ACTIVE",
                      "status_description": "Active",
                        "triparentlocationtx": "\\Locations\\Maximo Property\\Maximo Building\\Maximo Floor\\ADDR1001",
                     "trispaceclassificationtx": "\\Classifications\\Space Class Current\\Alternative Workplace",
                      "statusdate": "1999-12-07T14:34:00-08:00",
                      "type": "OPERATING",
                      "type_description": "Operating Location",
                      "useinpopr": false
                    }
                  ],
                  "lochierarchyid": 1,
                  "locsystem": [
                    {
                      "_rowstamp": "133414",
                      "address": false,
                      "description": "Primary Hierarchy",
                      "hasld": false,
                      "langcode": "EN",
                      "locsystemid": 4,
                      "network": false,
                      "orgid": "EAGLENA",
                      "primarysystem": true
                    }
                  ],
                  "orgid": "EAGLENA",
                  "parent": "MOFLOOR1",
                  "siteid": "BEDFORD",
                  "systemid": "PRIMARY"
                }
                  ]
                }
              output-schema:
                $schema: http://json-schema.org/draft-04/schema#
                type: object
                properties:
                  member:
                    type: array
                    items:
                      type: object
                      properties:
                        _action:
                          type: string
                        _rowstamp:
                          type: string
                        children:
                          type: boolean
                        externalrefid:
                          type: string
                        location:
                          type: string
                        locations:
                          type: array
                          items:
                            type: object
                            properties:
                              _rowstamp:
                                type: string
                              autowogen:
                                type: boolean
                              changeby:
                                type: string
                              changedate:
                                type: string
                              description:
                                type: string
                              disabled:
                                type: boolean
                              glaccount:
                                type: string
                              hasld:
                                type: boolean
                              isdefault:
                                type: boolean
                              isrepairfacility:
                                type: boolean
                              langcode:
                                type: string
                              locationsid:
                                type: number
                              orgid:
                                type: string
                              pluscloop:
                                type: boolean
                              pluscpmextdate:
                                type: boolean
                              replacecost:
                                type: number
                              status:
                                type: string
                              status_description:
                                type: string
                              triparentlocationtx:
                                type: string
                              trispaceclassificationtx:
                                type: string
                              statusdate:
                                type: string
                              type:
                                type: string
                              type_description:
                                type: string
                              useinpopr:
                                type: boolean
                        lochierarchyid:
                          type: number
                        locsystem:
                          type: array
                          items:
                            type: object
                            properties:
                              _rowstamp:
                                type: string
                              address:
                                type: boolean
                              description:
                                type: string
                              hasld:
                                type: boolean
                              langcode:
                                type: string
                              locsystemid:
                                type: number
                              network:
                                type: boolean
                              orgid:
                                type: string
                              primarysystem:
                                type: boolean
                        orgid:
                          type: string
                        parent:
                          type: string
                        siteid:
                          type: string
                        systemid:
                          type: string
                title: Parsed JSON
          - set-variable:
              name: Set variable 5
              map:
                $map: http://ibm.com/appconnect/map/v1
                customSchemas:
                  properties.`variable`:
                    type: object
                    properties:
                      triparentlocationtx:
                        type: string
                input:
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                  - variable: flowDetails
                    $ref: '#/flowDetails'
                mappings:
                  - variable:
                      mappings:
                        - triparentlocationtx:
                            template: >-
                              \\Locations\\Maximo Property\\Maximo
                              Building\\Maximo Floor
          - for-each:
              name: For each
              assembly:
                $ref: '#/integration/assemblies/assembly-2'
              source:
                expression: $JSONParserParse.member
                input:
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                  - variable: Setvariable5
                    $ref: '#/node-output/Set variable 5/response/payload'
                  - variable: flowDetails
                    $ref: '#/flowDetails'
              mode: parallel
              continue-on-error: false
              map:
                $map: http://ibm.com/appconnect/map/v1
                input:
                  - variable: Foreachitem
                    $ref: '#/block/For each/current-item'
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: Setvariable2
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      2/response/payload
                  - variable: Setvariable3
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      3/response/payload
                  - variable: HTTPInvokemethod
                    $ref: >-
                      #/block/For each/node-output/HTTP Invoke
                      method/response/payload
                  - variable: HTTPInvokemethodMetadata
                    $ref: '#/block/For each/node-output/HTTP Invoke method/response'
                  - variable: Setvariable4
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      4/response/payload
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                customSchemas:
                  properties.`output`:
                    type: object
                    properties:
                      locationsSent:
                        type: array
                        items:
                          type: object
                          properties: {}
                mappings:
                  - output:
                      mappings:
                        - locationsSent:
                            expression: $append([],$Setvariable3.variable.trilocation)
              display-name: Maximo location
          - response:
              name: response-1
              reply-maps:
                - title: location successfully add custom operation
                  status-code: '200'
                  map:
                    $map: http://ibm.com/appconnect/map/v1
                    input:
                      - variable: Request
                        $ref: '#/trigger/payload'
                      - variable: Setvariable
                        $ref: '#/node-output/Set variable/response/payload'
                      - variable: JSONParserParse
                        $ref: '#/node-output/JSON Parser Parse/response/payload'
                      - variable: Foreach
                        $ref: '#/node-output/For each/response/payload'
                    mappings:
                      - locationsSent:
                          expression: '$Foreach.output.locationsSent '
                  input:
                    - variable: Request
                      $ref: '#/trigger/payload'
                    - variable: Setvariable
                      $ref: '#/node-output/Set variable/response/payload'
                    - variable: JSONParserParse
                      $ref: '#/node-output/JSON Parser Parse/response/payload'
                    - variable: Foreach
                      $ref: '#/node-output/For each/response/payload'
    assembly-2:
      assembly:
        execute:
          - set-variable:
              name: Set variable 2
              map:
                $map: http://ibm.com/appconnect/map/v1
                input:
                  - variable: Foreachitem
                    $ref: '#/block/For each/current-item'
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                  - variable: Setvariable5
                    $ref: '#/node-output/Set variable 5/response/payload'
                customSchemas:
                  properties.`variable`:
                    type: object
                    properties:
                      action:
                        type: string
                      triOperationTX:
                        type: string
                      triExternalReferenceTX:
                        type: string
                      triIdTX:
                        type: string
                      triNameTX:
                        type: string
                      triDescriptionTX:
                        type: string
                      triBarCodeEntryTX:
                        type: string
                      triMainPhoneTX:
                        type: string
                      triMainFaxTX:
                        type: string
                      triPrimMailStopTX:
                        type: number
                      triHazMatBL:
                        type: string
                      SysReserveFlag:
                        type: string
                      triEmergencyExitBL:
                        type: string
                      triAreaNU:
                        type: string
                      triSpaceClassificationTX:
                        type: string
                      triCapacityNU:
                        type: number
                      triCapacityFactorNU:
                        type: string
                      triEmergencyCapacityNU:
                        type: string
                      triOverflowCapcityNU:
                        type: string
                      triParentLocationTX:
                        type: string
                mappings:
                  - variable:
                      mappings:
                        - action:
                            template: Create Draft
                        - triDescriptionTX:
                            template: '{{$Foreachitem.description}}'
                        - triExternalReferenceTX:
                            template: >-
                              {{$boolean($Foreachitem.externalrefid)?$Foreachitem.externalrefid:$Foreachitem.location}}
                        - triIdTX:
                            template: '{{$Foreachitem.location}}'
                        - triNameTX:
                            template: '{{$Foreachitem.description}}'
                        - triOperationTX:
                            template: >-
                              {{$Foreachitem._action="Delete"?"Retire":"Create/Update"}}
                        - triParentLocationTX:
                            template: >-
                              {{$Foreachitem.locations.triparentlocationtx?$Foreachitem.locations.triparentlocationtx
                              :$Setvariable5.variable.triparentlocationtx}}
                        - triSpaceClassificationTX:
                            template: '{{$Foreachitem.trispaceclassificationtx}}'
          - set-variable:
              name: Set variable 3
              map:
                $map: http://ibm.com/appconnect/map/v1
                input:
                  - variable: Foreachitem
                    $ref: '#/block/For each/current-item'
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable2
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      2/response/payload
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                  - variable: Setvariable5
                    $ref: '#/node-output/Set variable 5/response/payload'
                  - variable: flowDetails
                    $ref: '#/flowDetails'
                customSchemas:
                  properties.`variable`:
                    type: object
                    properties:
                      trilocation:
                        type: object
                        properties: {}
                mappings:
                  - variable:
                      mappings:
                        - trilocation:
                            expression: >-
                              (    $ns:= "spi:";    $applyNS := function($prop)
                              {        $type($prop) = "object" ?          
                              $count($keys($prop)) > 0 ?           $applyNSObj
                              := $each($prop, function($v, $k) {               
                              $type($v) = "object"  or $type($v) = "array" ?
                              {$ns & $k: $applyNS($v)} :                 {$ns &
                              $k : $v}                }) ~> $merge() : {}    
                              :        $type($prop) = "array" ?           
                              $count($prop) > 0 ?            $applyNSArr :=
                              $map($prop, function($v){                $type($v)
                              = "object"  or $type($v) = "array" ? $applyNS($v)
                              : $v            })[] : []    };   
                              $sift($applyNS($Setvariable2.variable),function($v){$boolean($v)});)
          - custom-action:
              name: HTTP Invoke method
              target:
                $ref: '#/integration/action-interfaces/action-interface-2'
              action: INVOKE
              map:
                customSchemas:
                  properties.`requestHeaders`:
                    type: object
                    properties:
                      Content-Type:
                        type: string
                      Properties:
                        type: string
                mappings:
                  - continue2xx:
                      expression: 'false'
                  - method:
                      template: POST
                  - requestBody:
                      template: '{{$Setvariable3.variable.trilocation}}'
                  - requestHeaders:
                      mappings:
                        - Content-Type:
                            template: application/json
                        - Properties:
                            template: spi:triTRIRIGAIDTX,spi:triUserMessageTX
                  - url:
                      template: '{{$api.triUrl}}'
                $map: http://ibm.com/appconnect/map/v1
                input:
                  - variable: Foreachitem
                    $ref: '#/block/For each/current-item'
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable2
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      2/response/payload
                  - variable: Setvariable3
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      3/response/payload
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                  - variable: Setvariable5
                    $ref: '#/node-output/Set variable 5/response/payload'
                  - variable: flowDetails
                    $ref: '#/flowDetails'
          - set-variable:
              name: Set variable 4
              map:
                $map: http://ibm.com/appconnect/map/v1
                input:
                  - variable: Foreachitem
                    $ref: '#/block/For each/current-item'
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable2
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      2/response/payload
                  - variable: Setvariable3
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      3/response/payload
                  - variable: HTTPInvokemethod
                    $ref: >-
                      #/block/For each/node-output/HTTP Invoke
                      method/response/payload
                  - variable: HTTPInvokemethodMetadata
                    $ref: '#/block/For each/node-output/HTTP Invoke method/response'
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                  - variable: Setvariable5
                    $ref: '#/node-output/Set variable 5/response/payload'
                  - variable: flowDetails
                    $ref: '#/flowDetails'
                customSchemas:
                  properties.`variable`:
                    type: object
                    properties:
                      tripayload:
                        type: object
                        properties: {}
                      triresponse:
                        type: object
                        properties: {}
                mappings:
                  - variable:
                      mappings:
                        - tripayload:
                            expression: $Setvariable3.variable.trilocation
                        - triresponse:
                            expression: '$HTTPInvokemethodMetadata '
          - set-variable:
              name: Set variable 6
              map:
                $map: http://ibm.com/appconnect/map/v1
                customSchemas:
                  properties.`variable`:
                    type: object
                    properties:
                      triRecordId:
                        type: object
                        properties: {}
                input:
                  - variable: Foreachitem
                    $ref: '#/block/For each/current-item'
                  - variable: Request
                    $ref: '#/trigger/payload'
                  - variable: api
                    $ref: '#/trigger/api/parameters'
                  - variable: Setvariable2
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      2/response/payload
                  - variable: Setvariable3
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      3/response/payload
                  - variable: HTTPInvokemethod
                    $ref: >-
                      #/block/For each/node-output/HTTP Invoke
                      method/response/payload
                  - variable: HTTPInvokemethodMetadata
                    $ref: '#/block/For each/node-output/HTTP Invoke method/response'
                  - variable: Setvariable4
                    $ref: >-
                      #/block/For each/node-output/Set variable
                      4/response/payload
                  - variable: Setvariable
                    $ref: '#/node-output/Set variable/response/payload'
                  - variable: JSONParserParse
                    $ref: '#/node-output/JSON Parser Parse/response/payload'
                  - variable: Setvariable5
                    $ref: '#/node-output/Set variable 5/response/payload'
                  - variable: flowDetails
                    $ref: '#/flowDetails'
                mappings:
                  - variable:
                      mappings:
                        - triRecordId:
                            expression: >-
                              $eval($Setvariable4.variable.triresponse.payload.responseBody)."spi:triTRIRIGAIDTX"
          - if:
              name: If
              input:
                - variable: Foreachitem
                  $ref: '#/block/For each/current-item'
                - variable: Request
                  $ref: '#/trigger/payload'
                - variable: api
                  $ref: '#/trigger/api/parameters'
                - variable: Setvariable2
                  $ref: '#/block/For each/node-output/Set variable 2/response/payload'
                - variable: Setvariable3
                  $ref: '#/block/For each/node-output/Set variable 3/response/payload'
                - variable: HTTPInvokemethod
                  $ref: >-
                    #/block/For each/node-output/HTTP Invoke
                    method/response/payload
                - variable: HTTPInvokemethodMetadata
                  $ref: '#/block/For each/node-output/HTTP Invoke method/response'
                - variable: Setvariable4
                  $ref: '#/block/For each/node-output/Set variable 4/response/payload'
                - variable: Setvariable6
                  $ref: '#/block/For each/node-output/Set variable 6/response/payload'
                - variable: Setvariable
                  $ref: '#/node-output/Set variable/response/payload'
                - variable: JSONParserParse
                  $ref: '#/node-output/JSON Parser Parse/response/payload'
                - variable: Setvariable5
                  $ref: '#/node-output/Set variable 5/response/payload'
                - variable: flowDetails
                  $ref: '#/flowDetails'
              branch:
                - condition:
                    and:
                      - '{{$boolean($Setvariable6.variable.triRecordId)}}':
                          '=': 'true'
                      - '{{$Setvariable2.variable.triExternalReferenceTX}}': '{{$Foreachitem.location}}'
                  execute:
                    - set-variable:
                        name: Set variable 7
                        map:
                          $map: http://ibm.com/appconnect/map/v1
                          customSchemas:
                            properties.`variable`:
                              type: object
                              properties:
                                mxlocation:
                                  type: object
                                  properties:
                                    location:
                                      type: string
                                    externalrefid:
                                      type: string
                                    _action:
                                      type: string
                                    siteid:
                                      type: string
                          input:
                            - variable: Foreachitem
                              $ref: '#/block/For each/current-item'
                            - variable: Request
                              $ref: '#/trigger/payload'
                            - variable: api
                              $ref: '#/trigger/api/parameters'
                            - variable: Setvariable2
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                2/response/payload
                            - variable: Setvariable3
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                3/response/payload
                            - variable: HTTPInvokemethod
                              $ref: >-
                                #/block/For each/node-output/HTTP Invoke
                                method/response/payload
                            - variable: HTTPInvokemethodMetadata
                              $ref: >-
                                #/block/For each/node-output/HTTP Invoke
                                method/response
                            - variable: Setvariable4
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                4/response/payload
                            - variable: Setvariable6
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                6/response/payload
                            - variable: Setvariable
                              $ref: '#/node-output/Set variable/response/payload'
                            - variable: JSONParserParse
                              $ref: '#/node-output/JSON Parser Parse/response/payload'
                            - variable: Setvariable5
                              $ref: '#/node-output/Set variable 5/response/payload'
                            - variable: flowDetails
                              $ref: '#/flowDetails'
                          mappings:
                            - variable:
                                mappings:
                                  - mxlocation:
                                      mappings:
                                        - _action:
                                            template: AddChange
                                        - externalrefid:
                                            template: '{{$Setvariable6.variable.triRecordId}}'
                                        - location:
                                            template: '{{$Foreachitem.location}}'
                                        - siteid:
                                            template: '{{$Foreachitem.siteid}}'
                    - custom-action:
                        name: HTTP Invoke method 2
                        target:
                          $ref: '#/integration/action-interfaces/action-interface-5'
                        action: INVOKE
                        map:
                          customSchemas:
                            properties.`requestHeaders`:
                              type: object
                              properties:
                                Content-Type:
                                  type: string
                                x-method-override:
                                  type: string
                          mappings:
                            - continue2xx:
                                expression: 'false'
                            - method:
                                template: POST
                            - requestBody:
                                template: '{{$Setvariable7.variable.mxlocation}}'
                            - requestHeaders:
                                mappings:
                                  - Content-Type:
                                      template: application/json
                                  - x-method-override:
                                      template: SYNC
                            - url:
                                template: '{{$api.mxUrl}}'
                          $map: http://ibm.com/appconnect/map/v1
                          input:
                            - variable: Foreachitem
                              $ref: '#/block/For each/current-item'
                            - variable: Request
                              $ref: '#/trigger/payload'
                            - variable: api
                              $ref: '#/trigger/api/parameters'
                            - variable: Setvariable7
                              $ref: >-
                                #/block/If/node-output/Set variable
                                7/response/payload
                            - variable: Setvariable2
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                2/response/payload
                            - variable: Setvariable3
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                3/response/payload
                            - variable: HTTPInvokemethod
                              $ref: >-
                                #/block/For each/node-output/HTTP Invoke
                                method/response/payload
                            - variable: HTTPInvokemethodMetadata
                              $ref: >-
                                #/block/For each/node-output/HTTP Invoke
                                method/response
                            - variable: Setvariable4
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                4/response/payload
                            - variable: Setvariable6
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                6/response/payload
                            - variable: Setvariable
                              $ref: '#/node-output/Set variable/response/payload'
                            - variable: JSONParserParse
                              $ref: '#/node-output/JSON Parser Parse/response/payload'
                            - variable: Setvariable5
                              $ref: '#/node-output/Set variable 5/response/payload'
                    - set-variable:
                        name: Set variable 8
                        map:
                          $map: http://ibm.com/appconnect/map/v1
                          customSchemas:
                            properties.`variable`:
                              type: object
                              properties:
                                mxUpdateLocation:
                                  type: object
                                  properties:
                                    datasent:
                                      type: object
                                      properties: {}
                                    mxresponse:
                                      type: object
                                      properties: {}
                          input:
                            - variable: Foreachitem
                              $ref: '#/block/For each/current-item'
                            - variable: Request
                              $ref: '#/trigger/payload'
                            - variable: api
                              $ref: '#/trigger/api/parameters'
                            - variable: Setvariable7
                              $ref: >-
                                #/block/If/node-output/Set variable
                                7/response/payload
                            - variable: HTTPInvokemethod2
                              $ref: >-
                                #/block/If/node-output/HTTP Invoke method
                                2/response/payload
                            - variable: HTTPInvokemethod2Metadata
                              $ref: >-
                                #/block/If/node-output/HTTP Invoke method
                                2/response
                            - variable: Setvariable2
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                2/response/payload
                            - variable: Setvariable3
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                3/response/payload
                            - variable: HTTPInvokemethod
                              $ref: >-
                                #/block/For each/node-output/HTTP Invoke
                                method/response/payload
                            - variable: HTTPInvokemethodMetadata
                              $ref: >-
                                #/block/For each/node-output/HTTP Invoke
                                method/response
                            - variable: Setvariable4
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                4/response/payload
                            - variable: Setvariable6
                              $ref: >-
                                #/block/For each/node-output/Set variable
                                6/response/payload
                            - variable: Setvariable
                              $ref: '#/node-output/Set variable/response/payload'
                            - variable: JSONParserParse
                              $ref: '#/node-output/JSON Parser Parse/response/payload'
                            - variable: Setvariable5
                              $ref: '#/node-output/Set variable 5/response/payload'
                            - variable: flowDetails
                              $ref: '#/flowDetails'
                          mappings:
                            - variable:
                                mappings:
                                  - mxUpdateLocation:
                                      mappings:
                                        - datasent:
                                            expression: '$Setvariable7.variable.mxlocation '
                                        - mxresponse:
                                            expression: $HTTPInvokemethod2Metadata
              else:
                execute: []
              output-schema: {}
  name: PLUSTMXLocation2TRI
models:
  mxLocation:
    name: mxLocation
    properties:
      dummyID:
        required: false
        id: true
        type: string
      member:
        required: false
        id: false
        type:
          - type: {}
    plural: mxLocation
    description: ' '
    operations: {}
  triLocation:
    name: triLocation
    properties:
      dummyID:
        required: false
        id: true
        type: string
      locationsSent:
        required: false
        id: false
        type:
          - type: {}
    plural: triLocation
    description: ' '
    operations:
      synclocation: '#/integration/assemblies/assembly-1'
    methods:
      synclocation:
        name: synclocation
        display:
          name: syncLocation
        accessType: WRITE
        accepts:
          - arg: data
            type: mxLocation
            http:
              source: body
          - arg: triUrl
            type: string
            http:
              source: query
          - arg: mxUrl
            type: string
            http:
              source: query
        returns:
          arg: data
          type: triLocation
          root: true
        http:
          verb: POST
          path: /synclocation
        description: Send LOCATION record from MAXIMO to Tririga.
